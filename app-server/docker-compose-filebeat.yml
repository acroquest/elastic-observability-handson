version: "3"

services:
  filebeat:
    image: docker.elastic.co/beats/filebeat:7.4.0
    volumes:
      - ./filebeat/conf/filebeat.yml:/usr/share/filebeat/filebeat.yml
      - ./filebeat/conf/nginx.yml:/usr/share/filebeat/modules.d/nginx.yml
      - ./nginx/log/:/var/log/nginx
      - ./springboot/log/:/var/log/springboot
    networks:
      - petclinic-elk-network
## metricbeat for docker ##
#  metricbeat:
#    image: docker.elastic.co/beats/metricbeat:7.4.0
#    user: root
#    volumes:
#      - ./metricbeat/conf/metricbeat.docker.yml:/usr/share/metricbeat/metricbeat.yml:ro
#      - /var/run/docker.sock:/var/run/docker.sock:ro
#      - /sys/fs/cgroup:/hostfs/sys/fs/cgroup:ro
#      - /proc:/hostfs/proc:ro
#      - /:/hostfs:ro
#    command: metricbeat -e -E output.elasticsearch.hosts=["${ELASTIC_SERVER_IP}:9200"] --strict.perms=false
#    networks:
#      - petclinic-elk-network
networks:
  petclinic-elk-network:
